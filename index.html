<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Blog - Pensieri e Codice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', 'Meiryo', sans-serif;
            background-color: #faf9f5;
            color: #2c2c2c;
            line-height: 1.8;
            font-size: 16px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        header {
            text-align: center;
            margin-bottom: 60px;
            border-bottom: 1px solid #e8e6e0;
            padding-bottom: 40px;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 300;
            color: #1a1a1a;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .subtitle {
            color: #666;
            font-size: 1rem;
            font-weight: 300;
        }

        .new-post-section {
            background: white;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #f0ece4;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }

        input[type="text"], textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e8e6e0;
            border-radius: 6px;
            font-size: 16px;
            background: #faf9f5;
            font-family: inherit;
        }

        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #8b7355;
            background: white;
        }

        textarea {
            min-height: 300px;
            font-family: 'Monaco', 'Consolas', monospace;
            resize: vertical;
        }

        .btn {
            background: #8b7355;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            background: #755f46;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .posts-section {
            margin-top: 40px;
        }

        .post {
            background: white;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #f0ece4;
            position: relative;
        }

        .post-meta {
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 15px;
            border-bottom: 1px solid #f5f5f5;
            padding-bottom: 10px;
        }

        .post-title {
            font-size: 1.5rem;
            font-weight: 400;
            margin-bottom: 20px;
            color: #1a1a1a;
        }

        .post-content {
            line-height: 1.8;
        }

        .post-content h1, .post-content h2, .post-content h3 {
            margin: 20px 0 15px 0;
            color: #2c2c2c;
        }

        .post-content h1 { font-size: 1.8rem; font-weight: 500; }
        .post-content h2 { font-size: 1.4rem; font-weight: 500; }
        .post-content h3 { font-size: 1.2rem; font-weight: 500; }

        .post-content p {
            margin-bottom: 15px;
        }

        .post-content strong {
            font-weight: 600;
            color: #1a1a1a;
        }

        .post-content em {
            font-style: italic;
            color: #555;
        }

        .post-content pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 14px;
        }

        .post-content code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 14px;
        }

        .post-content pre code {
            background: none;
            padding: 0;
        }

        .delete-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #dc3545;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
        }

        .export-section {
            text-align: center;
            margin: 40px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid #f0ece4;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #888;
        }

        .markdown-help {
            font-size: 0.9rem;
            color: #666;
            margin-top: 10px;
        }

        .github-instructions {
            background: #e8f4fd;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
        }

        .github-instructions h3 {
            color: #0c5460;
            margin-bottom: 15px;
        }

        .github-instructions code {
            background: #d1ecf1;
            color: #0c5460;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .posts-index {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #f0ece4;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .new-post-section, .post {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AI Blog</h1>
            <div class="subtitle">Pensieri, codice e osservazioni sull'intelligenza artificiale</div>
        </header>

        <div class="github-instructions">
            <h3>üöÄ Setup per GitHub Pages</h3>
            <p>Per visualizzare i post su GitHub Pages, devi creare un file <code>posts-index.json</code> nella root del repository:</p>
            <ol style="margin: 15px 0 15px 20px;">
                <li>Scrivi i tuoi post nell'editor qui sotto</li>
                <li>Clicca "Genera posts-index.json" per creare l'indice</li>
                <li>Carica il file nel tuo repository GitHub</li>
                <li>I post verranno visualizzati automaticamente!</li>
            </ol>
        </div>

        <div class="new-post-section">
            <h2 style="margin-bottom: 20px; font-weight: 400;">Nuovo Post</h2>
            <form id="postForm">
                <div class="form-group">
                    <label for="title">Titolo</label>
                    <input type="text" id="title" placeholder="Il titolo del tuo post..." required>
                </div>
                
                <div class="form-group">
                    <label for="content">Contenuto (Markdown)</label>
                    <textarea id="content" placeholder="Scrivi il tuo post qui...

Esempi di formatting:
# Titolo
## Sottotitolo
**grassetto** *corsivo*

```python
def hello_ai():
    print('Ciao AI!')
```

- Lista
- Elementi
" required></textarea>
                    <div class="markdown-help">
                        Supporta: titoli (#), **grassetto**, *corsivo*, `codice inline`, blocchi di codice con ```
                    </div>
                </div>
                
                <button type="submit" class="btn">Pubblica Post</button>
            </form>
        </div>

        <div class="export-section">
            <button onclick="generatePostsIndex()" class="btn">üìù Genera posts-index.json</button>
            <button onclick="exportAllPostsAsMarkdown()" class="btn btn-secondary">üì• Scarica file Markdown</button>
            <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                Il file <code>posts-index.json</code> permette a GitHub Pages di caricare i tuoi post
            </div>
        </div>

        <div class="posts-section">
            <h2 style="margin-bottom: 30px; font-weight: 400;">I tuoi post</h2>
            
            <div class="posts-index" id="postsIndexStatus">
                <h3 style="margin-bottom: 10px;">Stato del caricamento</h3>
                <p id="loadingStatus">Controllo presenza di posts-index.json...</p>
            </div>
            
            <div id="postsContainer">
                <div class="empty-state">
                    <p>Caricamento post in corso...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sistema per GitHub Pages - usa un file indice JSON
        let posts = [];
        let isLoading = false;

        // Carica i post da posts-index.json
        async function loadPosts() {
            isLoading = true;
            updateLoadingStatus('Caricamento post in corso...');
            
            try {
                const response = await fetch('posts-index.json?' + Date.now()); // Cache busting
                
                if (!response.ok) {
                    throw new Error('File posts-index.json non trovato');
                }
                
                const postsData = await response.json();
                posts = postsData.sort((a, b) => new Date(b.dateISO) - new Date(a.dateISO));
                
                updateLoadingStatus(`‚úÖ Caricati ${posts.length} post da posts-index.json`);
                
            } catch (error) {
                console.log('posts-index.json non trovato, carico post di esempio');
                loadSamplePosts();
                updateLoadingStatus('‚ö†Ô∏è File posts-index.json non trovato. Usando post di esempio.');
            }
            
            isLoading = false;
            renderPosts();
        }

        // Aggiorna lo status di caricamento
        function updateLoadingStatus(message) {
            const statusEl = document.getElementById('loadingStatus');
            if (statusEl) {
                statusEl.textContent = message;
            }
        }

        // Carica post di esempio
        function loadSamplePosts() {
            posts = [
                {
                    id: 'sample-1',
                    title: "Introduzione ai Framework per AI",
                    content: `# Introduzione ai Framework per AI

I framework per l'intelligenza artificiale stanno rivoluzionando il modo in cui sviluppiamo applicazioni intelligenti.

## TensorFlow vs PyTorch

**TensorFlow** √® ottimo per la produzione, mentre **PyTorch** eccelle nella ricerca.

### Esempio con TensorFlow

\`\`\`python
import tensorflow as tf

model = tf.keras.Sequential([
    tf.keras.layers.Dense(128, activation='relu'),
    tf.keras.layers.Dense(10, activation='softmax')
])

model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])
\`\`\`

Questo √® solo l'inizio di un mondo affascinante!

## Risorse utili

Per approfondire:
- **Documentazione TensorFlow**: Completa e ben strutturata
- **PyTorch Tutorials**: Perfetti per iniziare
- **Kaggle**: Per datasets e competizioni`,
                    date: new Date().toLocaleDateString('it-IT'),
                    dateISO: new Date().toISOString().split('T')[0],
                    author: 'AI Blog',
                    categories: ['AI', 'Framework'],
                    tags: ['tensorflow', 'pytorch', 'machine-learning'],
                    fileName: '2025-01-15-introduzione-ai-framework.md'
                }
            ];
        }

        // Renderizza i post
        function renderPosts() {
            const container = document.getElementById('postsContainer');
            
            if (posts.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <p>Nessun post trovato</p>
                        <p style="margin-top: 10px; font-size: 0.9rem; color: #888;">
                            Scrivi il tuo primo post e genera il file posts-index.json
                        </p>
                    </div>
                `;
                return;
            }

            container.innerHTML = posts.map(post => `
                <article class="post">
                    <button class="delete-btn" onclick="deletePost('${post.id}')" title="Elimina post">√ó</button>
                    <div class="post-meta">
                        ${post.date} 
                        ${post.fileName ? `‚Ä¢ <code>${post.fileName}</code>` : ''}
                        ${post.author && post.author !== 'AI Blog' ? `‚Ä¢ ${post.author}` : ''}
                    </div>
                    <h2 class="post-title">${post.title}</h2>
                    <div class="post-content">${parseMarkdown(post.content)}</div>
                    ${post.categories && post.categories.length > 0 ? `
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #f0f0f0;">
                            <small style="color: #666;">
                                Categorie: ${post.categories.join(', ')} 
                                ${post.tags && post.tags.length > 0 ? `‚Ä¢ Tag: ${post.tags.join(', ')}` : ''}
                            </small>
                        </div>
                    ` : ''}
                </article>
            `).join('');
        }

        // Parser Markdown
        function parseMarkdown(text) {
            return text
                .replace(/```(\w+)?\n([\s\S]*?)```/g, '<pre><code>$2</code></pre>')
                .replace(/`([^`]+)`/g, '<code>$1</code>')
                .replace(/^### (.*$)/gm, '<h3>$1</h3>')
                .replace(/^## (.*$)/gm, '<h2>$1</h2>')
                .replace(/^# (.*$)/gm, '<h1>$1</h1>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/^\- (.*$)/gm, '<li>$1</li>')
                .replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>')
                .split('\n\n')
                .map(paragraph => {
                    if (paragraph.includes('<h1>') || paragraph.includes('<h2>') || 
                        paragraph.includes('<h3>') || paragraph.includes('<pre>') || 
                        paragraph.includes('<ul>')) {
                        return paragraph;
                    }
                    return paragraph.trim() ? `<p>${paragraph.replace(/\n/g, '<br>')}</p>` : '';
                })
                .join('');
        }

        // Aggiungi nuovo post
        document.getElementById('postForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('title').value;
            const content = document.getElementById('content').value;
            
            const newPost = {
                id: 'post-' + Date.now(),
                title: title,
                content: content,
                date: new Date().toLocaleDateString('it-IT'),
                dateISO: new Date().toISOString().split('T')[0],
                author: 'AI Blog',
                categories: ['AI'],
                tags: ['intelligenza-artificiale'],
                fileName: generateFileName(title, new Date().toLocaleDateString('it-IT'))
            };
            
            posts.unshift(newPost);
            renderPosts();
            
            // Reset form
            document.getElementById('title').value = '';
            document.getElementById('content').value = '';
            
            alert('Post aggiunto! Ricorda di generare il nuovo posts-index.json');
        });

        // Genera nome file
        function generateFileName(title, dateString) {
            const [day, month, year] = dateString.split('/');
            const isoDate = `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;
            
            const slug = title
                .toLowerCase()
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '')
                .replace(/[^a-z0-9\s-]/g, '')
                .replace(/\s+/g, '-')
                .replace(/-+/g, '-')
                .trim('-');
            
            return `${isoDate}-${slug}.md`;
        }

        // Genera posts-index.json
        function generatePostsIndex() {
            if (posts.length === 0) {
                alert('Nessun post da includere nell\'indice!');
                return;
            }
            
            const indexData = posts.map(post => ({
                id: post.id,
                title: post.title,
                content: post.content,
                date: post.date,
                dateISO: post.dateISO,
                author: post.author,
                categories: post.categories,
                tags: post.tags,
                fileName: post.fileName
            }));
            
            const jsonString = JSON.stringify(indexData, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'posts-index.json';
            link.click();
            
            URL.revokeObjectURL(url);
            
            alert('File posts-index.json generato! Caricalo nella root del tuo repository GitHub.');
        }

        // Esporta tutti i post come Markdown
        async function exportAllPostsAsMarkdown() {
            if (posts.length === 0) {
                alert('Nessun post da esportare!');
                return;
            }
            
            for (const post of posts) {
                const frontmatter = `---
title: "${post.title}"
date: ${post.dateISO}
author: "${post.author}"
categories: [${post.categories.map(c => `"${c}"`).join(', ')}]
tags: [${post.tags.map(t => `"${t}"`).join(', ')}]
---

`;
                
                const content = frontmatter + post.content;
                const blob = new Blob([content], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = post.fileName;
                link.click();
                
                URL.revokeObjectURL(url);
                
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            alert(`Esportati ${posts.length} file Markdown!`);
        }

        // Elimina post
        function deletePost(id) {
            if (confirm('Sei sicuro di voler eliminare questo post?')) {
                posts = posts.filter(post => post.id !== id);
                renderPosts();
            }
        }

        // Inizializza
        loadPosts();
    </script>
</body>
</html>